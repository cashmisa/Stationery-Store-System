@model LUSSIS.Models.WebDTO.RepAndDelegateDTO
@{
    ViewBag.Title = "Department Delegate";
}
<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<h2>Department Delegate</h2>

<table class="table">
    <tr>
        <th>
            @*@Html.DisplayNameFor(model => model.GetDelegate.Employee)*@
            Your Delegate
        </th>
        <th>
            From
        </th>
        <th>
            To
        </th>
    </tr>
    <tr>
        <td>
            @Html.DisplayFor(model => model.GetDelegate.Employee.FullName)
        </td>
        <td>
            @Html.DisplayFor(model => model.GetDelegate.StartDate)
        </td>
        <td>
            @Html.DisplayFor(model => model.GetDelegate.EndDate)
        </td>
    </tr>
</table>
<input type="submit" value="Revoke Delegate" />
<table class="table">
    <tr>
        <th>
            Set New Department Representative
        </th>
    </tr>
</table>


@using (Html.BeginForm("AddDelegate", "RepAndDelegate", FormMethod.Post))
{
    <input id="Emp" type="text" placeholder="Search for Employee" name="FullName" />
    <input id="Submit1" type="submit" value="Set Your New Delegate" />
    <input type="hidden" id="Emp2" name="DelegateEmp" />
    <br />

    <br />
    <span>From: <input id="tagsname2" type="date" /></span>

    <span>To: <input id="tagsname3" type="date" /></span>

    if (ViewBag.Message != null)
    {
        <span><font color="red" />@ViewBag.Message</span>
    }
}

@section scripts {
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#Submit1').prop('disabled', true);
            $('#Emp').keyup(function () {
                if ($(this).val() == '') {
                    $('#Submit1').prop('disabled', true);
                    //$('#tagsname').html('You selected none ');
                }
                else {
                    $('#Submit1').prop('disabled', false);
                }
            });
            $("#Emp").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "/RepAndDelegate/GetEmpForDelJson",
                        type: "GET",
                        dataType: "json",
                        data: { prefix: request.term },
                        success: function (data) {
                            response($.map(data, function (item) {
                                return { label: item.FullName, value: item.EmpNum };
                            }))
                        }
                    })
                },
                select: function (event, ui) {
                    event.preventDefault(); //default gives the value instead of label.
                    $('#Emp2').val(ui.item.value);
                    $(this).val(ui.item.label);
                    if (ui.item == null) {
                        $("#Emp").val('');
                        $('#Submit1').prop('disabled', true);
                    }
                    else {
                        //$('#tagsname').html('You selected: ' + ui.item.label);
                    }
                },
                change: function (event, ui) {
                    if (ui.item == null) {
                        $("#Emp").val('');
                        $('#Submit1').prop('disabled', true);

                    }
                    else {
                        $('#Submit1').prop('disabled', false);
                    }
                },
                focus: function (event, ui) {
                    $(this).val(ui.item.label);
                    if (ui.item == null) {
                        $("#Emp").val('');
                        $('#Submit1').prop('disabled', true);
                    }
                    else {
                        $('#Submit1').prop('disabled', false);
                    }
                },
                messages: {
                    noResults: "", results: ""
                }
            });;
        })
    </script>
}

<style type="text/css">
    td {
        width: 2%;
    }

    th {
        width: 2%;
    }
</style>